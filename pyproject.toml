[build-system]
build-backend = "hatchling.build"
requires = [
    "hatchling",
    "hatch-vcs",
    "semiwrap~=0.2.1",
    "hatch-meson~=0.1.0",
    "hatch-robotpy~=0.2.1",
    "wpilib~=2026.1.1",
]


[project]
name = "robotpy-rev"
dynamic = ["version"]
description = "REVLib for RobotPy"
license = "BSD-3-Clause"
dependencies = [
    "wpilib>=2026.1.1,<2027",
]

[[project.authors]]
name = "RobotPy Development Team"
email = "robotpy@googlegroups.com"

[project.urls]
"Source code" = "https://github.com/robotpy/robotpy-rev"


[tool.hatch.version]
source = "vcs"

[tool.hatch.build.hooks.vcs]
version-file = "rev/version.py"

[tool.hatch.build.targets.wheel]
packages = ["rev"]

#
# Autogenerated TOML via `python3 -m hatch_robotpy.from_vendor`
#

[[tool.hatch.build.hooks.robotpy.maven_lib_download]]
artifact_id = "REVLib-cpp"
group_id = "com.revrobotics.frc"
repo_url = "https://maven.revrobotics.com"
version = "2026.0.0"
staticlibs = ["REVLib"]
extract_to = "lib"

[[tool.hatch.build.hooks.robotpy.maven_lib_download]]
artifact_id = "REVLib-driver"
group_id = "com.revrobotics.frc"
repo_url = "https://maven.revrobotics.com"
version = "2026.0.0"
staticlibs = [ "REVLibDriver"]
extract_to = "lib"

[[tool.hatch.build.hooks.robotpy.maven_lib_download]]
artifact_id = "RevLibBackendDriver"
group_id = "com.revrobotics.frc"
repo_url = "https://maven.revrobotics.com"
version = "2026.0.0"
staticlibs = [
    "BackendDriver",
]
extract_to = "lib"
use_headers = false

[[tool.hatch.build.hooks.robotpy.maven_lib_download]]
artifact_id = "RevLibWpiBackendDriver"
group_id = "com.revrobotics.frc"
repo_url = "https://maven.revrobotics.com"
version = "2026.0.0"
staticlibs = [
    "REVLibWpi",
]
extract_to = "lib"
use_headers = false

#
# End autogenerated TOML
#


[tool.hatch.build.hooks.semiwrap]

[tool.hatch.build.hooks.meson]



[tool.semiwrap]
update_init = ["rev"]
scan_headers_ignore = [
    # rev
    "rev/CANCommonParameters.h",
    "rev/CANDetachedEncoderDriver.h",
    "rev/CANDetachedEncoderFrames.h",
    "rev/CANDetachedEncoderParameters.h",
    "rev/CANDeviceScanner.h",
    "rev/CANDriverPrivate.h",
    "rev/CANServoHubDriver.h",
    "rev/CANServoHubFrames.h",
    "rev/CANServoHubParameters.h",
    "rev/CANSparkDriver.h",
    "rev/CANSparkFrames.h",
    "rev/CANSparkParameters.h",
    "rev/REVCommon.h",
    "rev/REVLibDaemon.h",
    "rev/REVUtils.h",
    "rev/SparkFrameManager.h",
    "rev/StatusLoggerDriver.h",

    # rev/canupdate
    "rev/canupdate/CANSparkSWDL.h",
    "rev/canupdate/DfuSeFile.h",

    # rev/config
    "rev/config/DetachedEncoderParameters.h",

    # rev/rev
    "rev/rev/REVLibVersion.h",

    # rev/sim
    "rev/sim/CANDetachedEncoder.h",
    "rev/sim/CANServoHub.h",
    "rev/sim/CANSpark.h",
    "rev/sim/MAXMotion.h",
    "rev/sim/SmartCurrentLimit.h",

    # .
    "sparkbaseconfig_apply.h",
]

[tool.semiwrap.extension_modules."rev._rev"]
name = "rev"

depends = [
    "wpilib",
]

includes = [
    "lib/include"
]

[tool.semiwrap.extension_modules."rev._rev".headers]

# rev
AbsoluteEncoder = "rev/AbsoluteEncoder.h"
AnalogInput = "rev/AnalogInput.h"
# TODO: uncomment when GetFRCDeviceTypeText and GetFRCManufacturerText are
#       marked as `static inline`
# CANDeviceScanner = "rev/CANDeviceScanner.h"
CIEColor = "rev/CIEColor.h"
ClosedLoopTypes = "rev/ClosedLoopTypes.h"
ColorMatch = "rev/ColorMatch.h"
ColorSensorV3 = "rev/ColorSensorV3.h"
ConfigureTypes = "rev/ConfigureTypes.h"
DetachedEncoder = "rev/DetachedEncoder.h"
DetachedEncoderLowLevel = "rev/DetachedEncoderLowLevel.h"
REVLibError = "rev/REVLibError.h"
RelativeEncoder = "rev/RelativeEncoder.h"
ServoChannel = "rev/ServoChannel.h"
ServoHub = "rev/ServoHub.h"
ServoHubLowLevel = "rev/ServoHubLowLevel.h"
ServoHubSim = "rev/ServoHubSim.h"
SparkAbsoluteEncoder = "rev/SparkAbsoluteEncoder.h"
SparkAnalogSensor = "rev/SparkAnalogSensor.h"
SparkBase = "rev/SparkBase.h"
SparkClosedLoopController = "rev/SparkClosedLoopController.h"
SparkFlex = "rev/SparkFlex.h"
SparkFlexExternalEncoder = "rev/SparkFlexExternalEncoder.h"
SparkLimitSwitch = "rev/SparkLimitSwitch.h"
SparkLowLevel = "rev/SparkLowLevel.h"
SparkMax = "rev/SparkMax.h"
SparkMaxAlternateEncoder = "rev/SparkMaxAlternateEncoder.h"
SparkRelativeEncoder = "rev/SparkRelativeEncoder.h"
SparkSim = "rev/SparkSim.h"
SparkSoftLimit = "rev/SparkSoftLimit.h"
SplineEncoder = "rev/SplineEncoder.h"

# rev/config
AbsoluteEncoderConfig = "rev/config/AbsoluteEncoderConfig.h"
AbsoluteEncoderConfigAccessor = "rev/config/AbsoluteEncoderConfigAccessor.h"
AlternateEncoderConfig = "rev/config/AlternateEncoderConfig.h"
AlternateEncoderConfigAccessor = "rev/config/AlternateEncoderConfigAccessor.h"
AnalogSensorConfig = "rev/config/AnalogSensorConfig.h"
AnalogSensorConfigAccessor = "rev/config/AnalogSensorConfigAccessor.h"
BaseConfig = "rev/config/BaseConfig.h"
ClosedLoopConfig = "rev/config/ClosedLoopConfig.h"
ClosedLoopConfigAccessor = "rev/config/ClosedLoopConfigAccessor.h"
DetachedEncoderConfig = "rev/config/DetachedEncoderConfig.h"
DetachedEncoderConfigAccessor = "rev/config/DetachedEncoderConfigAccessor.h"
DetachedSignalsConfig = "rev/config/DetachedSignalsConfig.h"
EncoderConfig = "rev/config/EncoderConfig.h"
EncoderConfigAccessor = "rev/config/EncoderConfigAccessor.h"
ExternalEncoderConfig = "rev/config/ExternalEncoderConfig.h"
ExternalEncoderConfigAccessor = "rev/config/ExternalEncoderConfigAccessor.h"
FeedForwardConfig = "rev/config/FeedForwardConfig.h"
FeedForwardConfigAccessor = "rev/config/FeedForwardConfigAccessor.h"
LimitSwitchConfig = "rev/config/LimitSwitchConfig.h"
LimitSwitchConfigAccessor = "rev/config/LimitSwitchConfigAccessor.h"
MAXMotionConfig = "rev/config/MAXMotionConfig.h"
MAXMotionConfigAccessor = "rev/config/MAXMotionConfigAccessor.h"
ServoChannelConfig = "rev/config/ServoChannelConfig.h"
ServoChannelConfigAccessor = "rev/config/ServoChannelConfigAccessor.h"
ServoHubConfig = "rev/config/ServoHubConfig.h"
ServoHubConfigAccessor = "rev/config/ServoHubConfigAccessor.h"
ServoHubParameters = "rev/config/ServoHubParameters.h"
SignalsConfig = "rev/config/SignalsConfig.h"
SignalsConfigAccessor = "rev/config/SignalsConfigAccessor.h"
SoftLimitConfig = "rev/config/SoftLimitConfig.h"
SoftLimitConfigAccessor = "rev/config/SoftLimitConfigAccessor.h"
SparkBaseConfig = "rev/config/SparkBaseConfig.h"
SparkBaseConfigAccessor = "rev/config/SparkBaseConfigAccessor.h"
SparkFlexConfig = "rev/config/SparkFlexConfig.h"
SparkFlexConfigAccessor = "rev/config/SparkFlexConfigAccessor.h"
SparkMaxConfig = "rev/config/SparkMaxConfig.h"
SparkMaxConfigAccessor = "rev/config/SparkMaxConfigAccessor.h"
SparkParameters = "rev/config/SparkParameters.h"

# rev/sim
DetachedEncoderSim = "rev/sim/DetachedEncoderSim.h"
MovingAverageFilterSim = "rev/sim/MovingAverageFilterSim.h"
NoiseGenerator = "rev/sim/NoiseGenerator.h"
ServoHubSimFaultManager = "rev/sim/ServoHubSimFaultManager.h"
SparkAbsoluteEncoderSim = "rev/sim/SparkAbsoluteEncoderSim.h"
SparkAnalogSensorSim = "rev/sim/SparkAnalogSensorSim.h"
SparkExternalEncoderSim = "rev/sim/SparkExternalEncoderSim.h"
SparkFlexSim = "rev/sim/SparkFlexSim.h"
SparkLimitSwitchSim = "rev/sim/SparkLimitSwitchSim.h"
SparkMaxAlternateEncoderSim = "rev/sim/SparkMaxAlternateEncoderSim.h"
SparkMaxSim = "rev/sim/SparkMaxSim.h"
SparkRelativeEncoderSim = "rev/sim/SparkRelativeEncoderSim.h"
SparkSimFaultManager = "rev/sim/SparkSimFaultManager.h"

# rev/util
StatusLogger = "rev/util/StatusLogger.h"
